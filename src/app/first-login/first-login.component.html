<div class="change-password-container">
  <div class="change-password-card">
    <div class="header-section">
      <h3>Changement de mot de passe requis</h3>
      <p class="subtitle">{{ firstLoginMessage }}</p>
    </div>

    <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="newPassword" class="form-label">Nouveau mot de passe</label>
        <div class="input-with-icon">
          <i class="fas fa-lock"></i>
          <input
            type="password"
            class="form-control"
            id="newPassword"
            formControlName="newPassword"
            placeholder="Entrez votre nouveau mot de passe"
          />
        </div>
        
        <!-- Erreurs de validation du mot de passe -->
        <div *ngIf="newPassword?.invalid && newPassword?.touched" class="text-danger mt-1">
          <div *ngIf="newPassword?.errors?.['required']">
            Le nouveau mot de passe est requis.
          </div>
          <div *ngIf="newPassword?.errors?.['minlength']">
            Le mot de passe doit contenir au moins 8 caract√®res.
          </div>
          <div *ngIf="newPassword?.errors?.['passwordStrength']">
            <div>Le mot de passe doit contenir :</div>
            <ul class="password-requirements">
              <li *ngFor="let error of getPasswordStrengthErrors()">{{ error }}</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword" class="form-label">Confirmer le mot de passe</label>
        <div class="input-with-icon">
          <i class="fas fa-lock"></i>
          <input
            type="password"
            class="form-control"
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirmez votre nouveau mot de passe"
          />
        </div>
        
        <div *ngIf="confirmPassword?.invalid && confirmPassword?.touched" class="text-danger mt-1">
          <div *ngIf="confirmPassword?.errors?.['required']">
            La confirmation du mot de passe est requise.
          </div>
        </div>
        
        <div *ngIf="changePasswordForm.errors?.['passwordMismatch'] && confirmPassword?.touched" class="text-danger mt-1">
          Les mots de passe ne correspondent pas.
        </div>
      </div>

      <button
        type="submit"
        class="btn-change-password"
        [disabled]="!changePasswordForm.valid || isLoading"
      >
        <span *ngIf="!isLoading">Changer le mot de passe</span>
        <span *ngIf="isLoading">
          <i class="fas fa-spinner fa-spin"></i> Changement en cours...
        </span>
      </button>

      <p *ngIf="errorMessage" class="text-danger text-center mt-3 animate__animated animate__shakeX">
        {{ errorMessage }}
      </p>
      
      <p *ngIf="successMessage" class="text-success text-center mt-3 animate__animated animate__fadeIn">
        {{ successMessage }}
      </p>
    </form>

  
  </div>
</div>